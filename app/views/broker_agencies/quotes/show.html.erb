<div class="module container broker_quote_tool">
  <div class="row" class="col-md-12">
   <input name='employee' value='50' type='hidden'>
   <input name='spouse' value='0' type='hidden'>
   <input name='domestic_partner' value='0' type='hidden'>
   <input name='child_under_26' value='0' type='hidden'>
    <%= form_tag(broker_agencies_quotes_root_path, method: :get) do  %>

    <h2>Quote Calculator</h2>

      <%= render partial: 'my_features' unless @q.published? %>

      <%= render partial: 'my_plans' unless @q.published? %>

      <% end %>
      <%= render partial: 'broker_agencies/quotes/panels/dental'  unless @q.published? %>
      <%= render partial: 'broker_agencies/quotes/panels/quote' %>

    </div>
  </div>
</div>


<script type="text/javascript">

$(document).on('ready page:load', function () {
    window.select_health_plans = <%=raw @health_plan_quote_criteria %>
    health_plan_count = Object.keys(window.select_health_plans).length
    deductible_value = 6000
    quote_change("<%= @q.id%>", "<%= @quote_on_page.id%>")

    window.relationship_benefits = <%= raw @benefit_pcts_json %>
    window.dental_relationship_benefits = window.relationship_benefits

    window.roster_premiums = <%= raw @roster_premiums_json %>
    window.dental_roster_premiums = <%= raw @dental_roster_premiums %>

    set_plan_costs()
    slider_listeners()
    page_load_listeners()
    toggle_plans(<%= raw @quote_criteria %>)
    $('#PlanComparison').on('click', function(){
       sort_plans()
    });

    $('.dental_carrier, .dental_metal, .dental_plan_type, .dc_network, .nationwide').on('click', function(){

      class_name = $(this).attr('class')

      $("." + class_name).each(function(){
        $(this).removeClass('active1')
      });

      $(this).addClass('active1')

      $('#dental_plans_container').click()

      $.each($('#dental-feature-mgmt'), function() {
        $(this).click();
      });

      carrier_id = $('#dental-carriers').find('div.active1').attr('data-carrier')
      dental_level = $('#dental-metals').find('div.active1').attr('id')
      plan_type = $('#dental-plan_types').find('div.active1').attr('id')
      dc_network = $('#dental-dc_in_network').find('div.active1').attr('id')
      nationwide = $('#dental-nationwide').find('div.active1').attr('id')
      quote = $('#quote').val()

      $.get('/broker_agencies/quotes/dental_plans_data/', {
                                                            carrier_id: carrier_id,
                                                            dental_level: dental_level,
                                                            plan_type: plan_type,
                                                            dc_network: dc_network,
                                                            nationwide: nationwide,
                                                            quote: quote
                                                          }
                                                        );
    });
});
</script>
